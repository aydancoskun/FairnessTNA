SUMMARY:
========
We had to take a good look at the way the license for Timetrex is implemented and what it
actually means because it and the source code of the software has a few gotchas. This is
probably the reason no one else has ever forked TimeTrex. Below is a list of what was found.

Just to be clear upfront: This is in no way a slight against Timetrex and especially Mike,
in any way. We believe that part of the licensing choices that were made are either a
clear oversight, misunderstanding or have their roots in the history of the Timetrex
licensing model. 

They basically produced an excellent product and then made a limited version available as
the TimeTrex Community Edition. It is limited because it does not allow you to add more
than 10 or 15 users after which you are informed that you should buy their professional
software.

However, evem though limited this is open source software licensed under the GNU AFFERO 
GENERAL PUBLIC LICENSE Version 3. So when you dive into the source code to find out
what is going on and you attempt to change any part of the software to allow more users or
to add further functionality, you have to wade through, as we have done, a host of 
obfuscated source code and other attempted "effective technological measures" with direct
statements in the source code that attempt to forbid you to circumvent their technological
measures.

TimeTrex have made the choice to license their work under the AGPL however reading through
the source code there is all sorts of additional restrictions imposed that are simply not
in accordance with the AGPL.

LICENSE SECTION:
================
Each source file states the following:

/****************************** ***************************************************
 * TimeTrex is a Workforce Management program developed by
 * TimeTrex Software Inc. Copyright (C) 2003 - 2018 TimeTrex Software Inc.
 *
 * This program is free software; you can redistribute it and/or modify it under
 * the terms of the GNU Affero General Public License version 3 as published by
 * the Free Software Foundation with the addition of the following permission
 * added to Section 15 as permitted in Section 7(a): FOR ANY PART OF THE COVERED
 * WORK IN WHICH THE COPYRIGHT IS OWNED BY TIMETREX, TIMETREX DISCLAIMS THE
 * WARRANTY OF NON INFRINGEMENT OF THIRD PARTY RIGHTS.
 *
 * This program is distributed in the hope that it will be useful, but WITHOUT
 * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
 * FOR A PARTICULAR PURPOSE.  See the GNU Affero General Public License for more
 * details.
 *
 * You should have received a copy of the GNU Affero General Public License along
 * with this program; if not, see http://www.gnu.org/licenses or write to the Free
 * Software Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA
 * 02110-1301 USA.
 *
 * You can contact TimeTrex headquarters at Unit 22 - 2475 Dobbin Rd. Suite
 * #292 West Kelowna, BC V4T 2E9, Canada or at email address info@timetrex.com.
 *
 * The interactive user interfaces in modified source and object code versions
 * of this program must display Appropriate Legal Notices, as required under
 * Section 5 of the GNU Affero General Public License version 3.
 *
 * In accordance with Section 7(b) of the GNU Affero General Public License
 * version 3, these Appropriate Legal Notices must retain the display of the
 * "Powered by TimeTrex" logo. If the display of the logo is not reasonably
 * feasible for technical reasons, the Appropriate Legal Notices must display
 * the words "Powered by TimeTrex".
 ********************************************************************************/

In he last two paragraphs it sounds like that what Timetrex is tying to do is making sure
that any future fork or derivative work will diplay the "Powered by TimeTrex" Logo or say
"Powered by TimeTrex." on every page of the user interface. TimeTrex is referring to 
section 7b of the AGPL.

Section 7b states the following in the contexts of allowed additional restrictions:

    b) Requiring preservation of specified reasonable legal notices or
    author attributions in that material or in the Appropriate Legal
    Notices displayed by works containing it;

In the Terms and Conditions of the AGPL section 0 Definitions reasonable legal notices are
defined:

	An interactive user interface displays "Appropriate Legal Notices"
	to the extent that it includes a convenient and prominently visible
	feature that (1) displays an appropriate copyright notice, and (2)
	tells the user that there is no warranty for the work (except to the
	extent that warranties are provided), that licensees may convey the
	work under this License, and how to view a copy of this License.  If
	the interface presents a list of user commands or options, such as a
	menu, a prominent item in the list meets this criterion.

Anything further than the above falls under section 7

    All other non-permissive additional terms are considered "further
    restrictions" within the meaning of section 10.  If the Program as you
    received it, or any part of it, contains a notice stating that it is
    governed by this License along with a term that is a further
    restriction, you may remove that term.  If a license document contains
    a further restriction but permits relicensing or conveying under this
    License, you may add to a covered work material governed by the terms
    of that license document, provided that the further restriction does
    not survive such relicensing or conveying.


From a legal standpoint we are forking this software and it is now called "FairnessTNA". 
Obviously putting "Powered by Timetrex" onto every page is nonsense for an open source
product. But there is of course the valid point of attribution and copyright.
We are giving full attribution to TimeTrex in the "About" menu in the "Credits" and
"Copyright" tabs.

Since Section 0 "Definitions" of the AGPL is very clear as to what is meant by 
"Appropriate Legal Notices". We are removing the "Additional Restriction" imposed by their
last paragraph from our released modified source versions.

CODE SECTION:
=============
The other point found in violation of the AGPL is the part of the AGPL basically allowing
any reverse engineering:

Section 3 of the GNU AFFERO GENERAL PUBLIC LICENSE Version 3 states:

	3. Protecting Users' Legal Rights From Anti-Circumvention Law.

	No covered work shall be deemed part of an effective technological
	measure under any applicable law fulfilling obligations under article
	11 of the WIPO copyright treaty adopted on 20 December 1996, or
	similar laws prohibiting or restricting circumvention of such
	measures.

	When you convey a covered work, you waive any legal power to forbid
	circumvention of technological measures to the extent such circumvention
	is effected by exercising rights under this License with respect to
	the covered work, and you disclaim any intention to limit operation or
	modification of the work as a means of enforcing, against the work's
	users, your or third parties' legal rights to forbid circumvention of
	technological measures.

In the community edition of TimeTrex is an encrypted file called TTlicense.php. It states:
<?php /* Reverse engineering of this file is strictly prohibited. File protected by 
copyright law and provided under license. */

This is then followed by a bunch of eval() statements. The code is heavily obfuscated. 
Obviously Timetrex does not want you to look at it. We don't understand why that would
exist in an open source product. The whole point of open source is that the software is 
free of restrictions. 

The fact of using obfuscation is in violation of the AGPL as well as forbidding someone to
reverse engineer it.

Section 3 Conveying Non-Source Forms, of the GNU AFFERO GENERAL PUBLIC LICENSE Version 3
states:

    You may convey a covered work in object code form under the terms 
    of sections 4 and 5, provided that you also convey the
    machine-readable Corresponding Source under the terms of this License,
    in one of these ways (...)

Since we couldn't be bothered to decrypt it, we just deleted the file and any reference to
it in other files and made sure it just keep on working.

This is only the most obvious example. There are several other parts of the code that are
obfuscated with similar statements denying the rights of the AGPL.

All of those codes have been removed in the FairnessTNA conveyed versions.

One last point is that TimeTrex software "phones home" without telling the user.
It does that a LOT. It uses several ways to do so. A soap interface, plain "fopen" calls
during every step of the install process or sending itself emails. We understand why they
are doing it, but please let people know and get permission first. Google Analytics is also
used to document every page load including host names and "licensing information", number
of users etc.

All that has been removed in FairnessTNA.

NOTES:
======

For the record we are keeping a list of files that we found that have other 
"further restrictions" imposed which we removed:

CompanyFactory.class.php

PunchFactory.class.php

ScheduleFactory.class.php

UserContactFactory.class.php

UserFactory.class.php

UserList.class.php

	$obj_class = "\124\124\114\x69\x63\x65\x6e\x73\x65"; $obj_function =
	"\166\x61\154\x69\144\x61\164\145\114\x69\x63\145\x6e\x73\x65"; $obj_error_msg_function =
	"\x67\x65\x74\x46\x75\154\154\105\162\x72\x6f\x72\115\x65\x73\163\141\x67\x65"; @$obj = new
	$obj_class; $retval = $obj->{$obj_function}(); if ( $retval !== TRUE ) { $this->Validator-
	>isTrue( 'lic_obj', FALSE, $obj->{$obj_error_msg_function}($retval) ); }

We found this tabbed over by more than 80 characters (so that you won't see this code when
you scroll though the file unless you have linewrap turned on) all on one line obfuscated
code in the six files above.

global.inc.php
	// **REMOVING OR CHANGING THIS APPLICATION NAME AND ORGANIZATION URL IS IN STRICT VIOLATION OF THE LICENSE AND COPYRIGHT AGREEMENT**
	( isset($config_vars['branding']['application_name']) AND $config_vars['branding']['application_name'] != '' ) ? define('APPLICATION_NAME', $config_vars['branding']['application_name']) : define('APPLICATION_NAME', (PRODUCTION == FALSE) ? 'TimeTrex-Debug' : 'TimeTrex');
	( isset($config_vars['branding']['organization_name']) AND $config_vars['branding']['organization_name'] != '' ) ? define('ORGANIZATION_NAME', $config_vars['branding']['organization_name']) : define('ORGANIZATION_NAME', 'TimeTrex');
	( isset($config_vars['branding']['organization_url']) AND $config_vars['branding']['organization_url'] != '' ) ? define('ORGANIZATION_URL', $config_vars['branding']['organization_url']) : define('ORGANIZATION_URL', 'www.TimeTrex.com');

send_file.php
	//
	//REMOVING OR CHANGING THIS LOGO IS IN STRICT VIOLATION OF THE LICENSE AGREEMENT AND COPYRIGHT LAWS.
	//
	if ( getTTProductEdition() > 10 ) { $file_name = Environment::getImagesPath().'/powered_by.jpg';Debug::Text('File Name: '. $file_name, __FILE__, __LINE__, __METHOD__,10);if ( $file_name != '' AND file_exists($file_name) ) { $params['file'] = $file_name;$params['contentdisposition'] = 'attachment; filename=pro_copyright.jpg';$params['data'] = file_get_contents($file_name);$params['cache'] = TRUE;}} else {$params['contentdisposition'] = 'attachment; filename=copyright.jpg';$params['data'] = base64_decode('/9j/4AAQSkZJRgABA (... loads more img data ...) 2K0aqSg7KStZeOmNPK//9k=');$params['cache'] = TRUE;}

NOTES 15 October 2019:
======================

There are many changes to the above since I had time to update this:
These are my notes of the conversion from timetrex to fairnesstna

Delete content of files.sha exept first line
Delete timetrex .ini.php-example_windows
delete timetrex .ini.php-example_linux
delete readme.txt
create readme.md as in repo
create VERSION with current version
replace all instances of 
/****************************** ***************************************************
 * TimeTrex is a Workforce Management program developed by
 * TimeTrex Software Inc. Copyright (C) 2003 - 2018 TimeTrex Software Inc.
 *
 * This program is free software; you can redistribute it and/or modify it under
 * the terms of the GNU Affero General Public License version 3 as published by
 * the Free Software Foundation with the addition of the following permission
 * added to Section 15 as permitted in Section 7(a): FOR ANY PART OF THE COVERED
 * WORK IN WHICH THE COPYRIGHT IS OWNED BY TIMETREX, TIMETREX DISCLAIMS THE
 * WARRANTY OF NON INFRINGEMENT OF THIRD PARTY RIGHTS.
 *
 * This program is distributed in the hope that it will be useful, but WITHOUT
 * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
 * FOR A PARTICULAR PURPOSE.  See the GNU Affero General Public License for more
 * details.
 *
 * You should have received a copy of the GNU Affero General Public License along
 * with this program; if not, see http://www.gnu.org/licenses or write to the Free
 * Software Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA
 * 02110-1301 USA.
 *
 * You can contact TimeTrex headquarters at Unit 22 - 2475 Dobbin Rd. Suite
 * #292 West Kelowna, BC V4T 2E9, Canada or at email address info@timetrex.com.
 *
 * The interactive user interfaces in modified source and object code versions
 * of this program must display Appropriate Legal Notices, as required under
 * Section 5 of the GNU Affero General Public License version 3.
 *
 * In accordance with Section 7(b) of the GNU Affero General Public License
 * version 3, these Appropriate Legal Notices must retain the display of the
 * "Powered by TimeTrex" logo. If the display of the logo is not reasonably
 * feasible for technical reasons, the Appropriate Legal Notices must display
 * the words "Powered by TimeTrex".
 ********************************************************************************/
with 
/*********************************************************************************
 * FairnessTNA is a Workforce Management program forked from TimeTrex in 2013,
 * copyright Aydan Coskun. Original code base is copyright TimeTrex Software Inc.
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Affero General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU Affero General Public License for more details.
 *
 * You should have received a copy of the GNU Affero General Public License
 * along with this program.  If not, see <http://www.gnu.org/licenses/>.
 *
 * You can contact Aydan Coskun via issue tracker on github.com/aydancoskun
 ********************************************************************************/

remove all lines with @fclose($handle);
remove all lines with $handle = @fopen
remove line in APIInstall.class.php with $handle = fopen in it and the fclose($handle) below it
find and replace all "$license->getHardwareID()" with "'hardware_id'"
find and replace all "$hardware_id" with "'hardware_id'"
remove lines in class_map containing 
    'TTLicense' => 'core/TTLicense.class.php',
    'TTLicense.private' => 'core/TTLicense.private.class.php',
    'TTLicenseGenerator' => 'core/TTLicenseGenerator.class.php',
search for "#: ../../classes/modules/core/TTLicense" and remove all referenc in translations
search for "Invalid license file or unable to activate license" and remove all reference in translations
search for "ERROR: Unable to communicate with license server, please check your internet connection" and remove all reference in translations
search $license_validate and remove block
search $license_message and remove block
search TTLicense and remove block
remove the TTLicense.class.php file
in APIAbout.class.php enter 
 		$data['show_license_data'] = FALSE;
		$data['license_data'] = FALSE;
		$data['hardware_id'] = FALSE;
		$data['registration_key']=FALSE;
        $data['product_edition']=FALSE;
	where the section was deleted with all the License data
in global.inc.php:
SetEnv TT_CONFIG_FILE /etc/time trex/time trex.ini.php => SetEnv TT_CONFIG_FILE /etc/fairnesstna/settings.ini.php
export TT_CONFIG_FILE=/etc/time trex/time trex.ini.php => export TT_CONFIG_FILE=/etc/fairnesstna/settings.ini.php
search and replace time trex.ini.php => settings.ini.php
create the settings.ini.php file
add functions to Misc.class.php:
	/**
	 * @return bool
	 */
	static function isLatestVersion($current_company=false) {
        //todo implement version check mechanism
		return true;
	}

	/**
	 * @return bool
	 */
	static function getInstallerLatestVersion() {
		return APPLICATION_VERSION;
	}

	/**
	 * @return bool
	 */
	static function isUpdateNotifyEnabled() {
		return false;
	}

	/**
	 * @return bool
	 */
	static function isNewVersionReadyForUpgrade($force=false) {
		return false;
	}

	/**
	 * @return bool
	 */
	static function ping() {
		return true;
	}

	/**
	 * @return bool
	 */
	static function getCurrencyExchangeRatesByDate( $company_id=false, $active_currency_iso_code_arr=false, $base_currency=false, $latest_currency_rate_date=false, $yesterday_middle_day_epoch=false){
        //todo implement currency update mechanism
	    return false;
	}

add the below to the TTDate.class.php to detect the timezone on modern macos
					elseif ( strpos( $filename, '/var/db/timezone/zoneinfo/' ) === 0 ) {
						$os_time_zone = substr( $filename, 26 );
					} 

search TimeTrexSoapClient and remove blocks
remove the TimeTrexSoapClient.class.php file
search SoapClientTimeout and remove blocks
remove the SoapClientTimeout.class.php file
remove modules/soap directory

search facebook and remove the login footer from LoginView.html and corresponding in LoginViewController.js
search quick_punch_link in LoginViewController.js and make it hide always as the code is missing
find the hidden code section in LoginViewController.js and remove it
search for testRemoteHTTP and change the address to blank.org

surgically remove google analytics by searching for and removing the relevant blocks
search for:
initAnalytics
analytics_enabled
analytics_tracking_code
setAnalyticDimensions
sendAnalyticsPageview
trackView
sendAnalyticsEvent
triggerAnalyticsContextMenuClick
triggerAnalyticsEditViewNavigation
triggerAnalyticsTabs
triggerAnalyticsNavigationOther

change any @timetrex.com email addresses

TFeedback ?? leave in for now as the GA has been removed
registration_key ?? leave in for now as mobile's may require somehting

search Workforce Management program forked from TimeTrex in 2013
replace Workforce Management program forked from TimeTrex in 2013

search Original code base is copyright TimeTrex Software
replace Original code base is copyright TimeTrex Software

deployment_on_demand

search for any timetrex TimeTrex TIMETREX etc and change all, do this manually and intelligently

copy api/client/TimeTrexClientAPI.class.php => api/client/ClientAPI.class.php
copy other/TimeTrexPaymentServices.class.php => other/PaymentServices.class.php

replace in the classmap file
    'ClientAPI' => 'api/client/ClientAPI.class.php',
    'TimeTrexClientAPI' => 'api/client/ClientAPI.class.php',
add to the classmap file, for some reason these are missing
	'PaymentServices' => 'other/PaymentServices.class.php',
	'TimeTrexPaymentServices' => 'other/PaymentServices.class.php',

add to PaymentServices.class.php
class_alias ( 'PaymentServices' , 'TimeTrexPaymentServices' );

add a class alias to ClientAPI.class.php as well, there are 2 classes in that file
